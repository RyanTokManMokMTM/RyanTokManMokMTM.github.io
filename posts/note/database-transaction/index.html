<!doctype html><html lang=zh-tw data-theme=dark><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#222" media="(prefers-color-scheme: dark)"><meta name=generator content="Hugo 0.147.8"><link rel="shortcut icon" type=image/x-icon href=/imgs-custom/customIcon/favicon.ico><link rel=icon type=image/x-icon href=/imgs-custom/customIcon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/imgs-custom/customIcon/favicon_16x16.png><link rel=icon type=image/png sizes=32x32 href=/imgs-custom/customIcon/favicon_32_32.png><link rel=apple-touch-icon sizes=180x180 href=/imgs-custom/icons/apple_touch_icon_next.png><meta itemprop=name content="[筆記] 淺談資料庫事務(Transcation)"><meta itemprop=description content="database-transcation"><meta name=description content="database-transcation"><meta itemprop=datePublished zgotmplz><meta itemprop=dateModified zgotmplz><meta itemprop=image content="https://ryantokmanmokmtm.github.io/imgs-custom/customIcon/avatar.jpg"><meta itemprop=keywords content="database"><link href=/css/pio.css rel=stylesheet type=text/css><link type=text/css rel=stylesheet href=https://ryantokmanmokmtm.github.io/js/3rd/font-awesome/6.7.2/css/all.min.css><link type=text/css rel=stylesheet href=https://ryantokmanmokmtm.github.io/js/3rd/animate.css/3.1.1/animate.min.css><link type=text/css rel=stylesheet href=https://ryantokmanmokmtm.github.io/js/3rd/viewerjs/1.11.6/viewer.min.css><link rel=stylesheet href="/css/main.min.css?=1749921714"><style type=text/css>.post-footer hr:after{content:"~ 我可是有底线的哟 ~"}.flinks-list-footer hr:after{content:"~ 我可是有底线的哟 ~"}</style><link rel=stylesheet type=text/css href="/css/custom_style.css?=1749921714"><script type=text/javascript>(function(){localDB={set:function(e,t,n){if(n===0)return;const s=new Date,o=n*864e5,i={value:t,expiry:s.getTime()+o};localStorage.setItem(e,JSON.stringify(i))},get:function(e){const t=localStorage.getItem(e);if(!t)return 0[0];const n=JSON.parse(t),s=new Date;return s.getTime()>n.expiry?(localStorage.removeItem(e),0[0]):n.value}},theme={active:function(){const e=localDB.get("theme");if(e==null)return;theme.toggle(e),window.matchMedia("(prefers-color-scheme: dark)").addListener(function(e){theme.toggle(e.matches?"dark":"light")})},toggle:function(e){document.documentElement.setAttribute("data-theme",e),localDB.set("theme",e,2);const t=document.querySelector("iframe.giscus-frame");if(t){const n={setConfig:{theme:e}};t.contentWindow.postMessage({giscus:n},"https://giscus.app")}}},theme.active()})(window)</script><script type=text/javascript>document.addEventListener("DOMContentLoaded",()=>{var e=document.createElement("script");e.charset="UTF-8",e.src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.async=!1,e.defer=!0,document.head.appendChild(e),e.onload=function(){NexT.utils.fmtBusuanzi()}})</script><title>[筆記] 淺談資料庫事務(Transcation) - Jackson.tmm</title><noscript><link rel=stylesheet href=/css/noscript.css></noscript></head><body itemscope itemtype=http://schema.org/WebPage class=use-motion><div class=headband></div><main class=main><header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle aria-label role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><a href=/ class=brand rel=start><i class=logo-line></i><h1 class=site-title>Jackson.tmm</h1><i class=logo-line></i></a><p class=site-subtitle itemprop=description>Loving life and dreams.</p></div><div class=site-nav-right><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul class="main-menu menu"><li class="menu-item menu-item-home"><a href=/ class=hvr-icon-pulse rel=section><i class="fa fa-home hvr-icon"></i>Home 首頁</a></li><li class="menu-item menu-item-categories"><a href=/categories/ class=hvr-icon-pulse rel=section><i class="fa fa-list hvr-icon"></i>Menu 目錄</a></li><li class="menu-item menu-item-about"><a href=/about.html class=hvr-icon-pulse rel=section><i class="fa fa-user hvr-icon"></i>About 關於</a></li><li class="menu-item menu-item-posts"><a href=/posts/ class=hvr-icon-pulse rel=section><i class="fa fa-archive hvr-icon"></i>Archives 歸檔</a></li><li class="menu-item menu-item-memories"><a href=/memories class=hvr-icon-pulse rel=section><i class="fa fa-star hvr-icon"></i>Memories 回憶</a></li><li class="menu-item menu-item-leetcodes"><a href=/leetcodes class=hvr-icon-pulse rel=section><i class="fa fa-code hvr-icon"></i>Leetcodes 力扣</a></li><li class="menu-item menu-item-project"><a href=/project class=hvr-icon-pulse rel=section><i class="fa fa-tasks hvr-icon"></i>Project 專案</a></li><li class="menu-item menu-item-achievement"><a href=/achievement class=hvr-icon-pulse rel=section><i class="fa fa-trophy hvr-icon"></i>Achievement 成就</a></li><li class="menu-item menu-item-resources"><a href=/resources class=hvr-icon-pulse rel=section><i class="fa fa-file hvr-icon"></i>Resources 資源</a></li><li class="menu-item menu-item-search"><a role=button class="popup-trigger hvr-icon-pulse"><i class="fa fa-search fa-fw hvr-icon"></i>搜索</a></li></ul></nav><div class=search-pop-overlay><div class="popup search-popup"><div class=search-header><span class=search-icon><i class="fa fa-search"></i></span><div class=search-input-container><input autocomplete=off autocapitalize=off maxlength=80 placeholder=搜索... spellcheck=false type=search class=search-input></div><span class=popup-btn-close role=button><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class=search-result-icon><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></div><div class="toggle sidebar-toggle" role=button><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div><aside class=sidebar><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class=sidebar-nav><li class=sidebar-nav-toc>文章目錄</li><li class=sidebar-nav-overview>站點概覽</li></ul><div class=sidebar-panel-container><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><nav id=TableOfContents><ul><li><a href=#簡介>簡介</a></li><li><a href=#什麼是事務transcation>什麼是事務(Transcation)</a></li><li><a href=#事務transcation的4大特性>事務(Transcation)的4大特性</a><ul><li><a href=#資源競爭問題>資源競爭問題</a></li><li><a href=#read-write的問題>Read-Write的問題</a><ul><li><a href=#幻讀phantom-read>幻讀(Phantom read)</a></li><li><a href=#不可重複讀non-repeated-read>不可重複讀(non-repeated read)</a></li><li><a href=#髒讀dirty-read>髒讀(dirty read)</a></li><li><a href=#一致性問題的解決方案>一致性問題的解決方案</a></li></ul></li><li><a href=#write-write>Write-Write</a><ul><li><a href=#鎖lock>鎖Lock</a></li><li><a href=#意向鎖-intention-lock>意向鎖 intention lock</a></li></ul></li></ul></li><li><a href=#總結>總結</a></li><li><a href=#參考資料>參考資料</a></li></ul></nav></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author site-overview-item animated" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image alt=Jackson.tmm src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/customIcon/avatar.jpg><p class=site-author-name itemprop=name>Jackson.tmm</p><div class=site-description itemprop=description>簡單紀錄生活和筆記</div></div><div class="site-state-wrap site-overview-item animated"><nav class=site-state><div class="site-state-item site-state-posts"><a href=/archives/><span class=site-state-item-count>34</span>
<span class=site-state-item-name>日誌</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>14</span>
<span class=site-state-item-name>分類</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>58</span>
<span class=site-state-item-name>標籤</span></a></div></nav></div><div class="links-of-social site-overview-item animated"><span class=links-of-social-item><a href=https://www.facebook.com/karot.ka.7505/ title="Facebook → https://www.facebook.com/karot.ka.7505/" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-facebook fa-fw hvr-icon"></i>
Facebook
</a></span><span class=links-of-social-item><a href=https://www.instagram.com/tm_m.0418 title="IG → https://www.instagram.com/tm_m.0418" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-instagram fa-fw hvr-icon"></i>
IG
</a></span><span class=links-of-social-item><a href=https://github.com/RyanTokManMokMTM title="Github → https://github.com/RyanTokManMokMTM" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-github fa-fw hvr-icon"></i>
Github
</a></span><span class=links-of-social-item><a href=https://www.linkedin.com/in/jackson-moktokman/ title="LinkedIn → https://www.linkedin.com/in/jackson-moktokman/" rel=noopener class=hvr-icon-pulse target=_blank><i class="fab fa-linkedin fa-fw hvr-icon"></i>
LinkedIn</a></span></div><div class="cc-license animated" itemprop=license><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hant class=cc-opacity rel=noopener target=_blank title=共享知識><img src=/imgs/img-lazy-loading.gif data-src=/imgs/cc/big/by_nc_sa.svg alt=共享知識></a></div><div class="links-of-blogroll site-overview-item animated"><div class=links-of-blogroll-title><i class="fa fa-globe fa-fw"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://cwksc.github.io/ title=https://cwksc.github.io/ target=_blank>CWKSC 一個什麼都學得會的人</a></li></ul></div></div>--></div></div></div><div id=siteinfo-card-widget class=sidebar-card-widget><div class=item-headline><i class="fas fa-chart-line"></i>
<span>網站資訊</span></div><div class=siteinfo><div class=siteinfo-item><div class=item-name><i class="fa-solid fa-calendar-check"></i>已運行：</div><div class=item-count id=runTimes data-publishdate="2022-03-24 13:52:49 +0800 +0800"></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-user"></i>總訪客數：</div><div class=item-count id=busuanzi_value_site_uv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fas fa fa-eye"></i>頁面瀏覽：</div><div class=item-count id=busuanzi_value_site_pv><i class="fa fa-sync fa-spin"></i></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-font"></i>總字數：</div><div class=item-count id=wordsCount data-count=55102></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-mug-hot"></i>閱讀約：</div><div class=item-count id=readTimes data-times=130></div></div><div class=siteinfo-item><div class=item-name><i class="fa fa-clock-rotate-left"></i>最後更新於：</div><div class=item-count id=last-push-date data-lastpushdate="2024-12-02 23:31:33 +0800 +0800"></div></div></div></div></aside><div class=sidebar-dimmer></div></header><div class=tool-buttons><div id=goto-comments class="button goto-comments" title=直達評論><i class="fas fa-comments"></i></div><div id=toggle-theme class=button title=深淺模式切換><i class="fas fa-adjust"></i></div><div class=back-to-top role=button title=返回頂部><i class="fa fa-arrow-up"></i>
<span>0%</span></div></div><div class=reading-progress-bar></div><a role=button class="book-mark-link book-mark-link-fixed"></a><a href=https://github.com/RyanTokManMokMTM rel="noopener external nofollow noreferrer" target=_blank title="Follow me on GitHub" class="exturl github-corner"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><noscript><div class=noscript-warning>Theme NexT works best with JavaScript enabled</div></noscript><div class="main-inner post posts-expand"><div class=post-block><article itemscope itemtype=http://schema.org/Article class=post-content lang><link itemprop=mainEntityOfPage href=https://ryantokmanmokmtm.github.io/posts/note/database-transaction/><span hidden itemprop=author itemscope itemtype=http://schema.org/Person><meta itemprop=image content="/imgs-custom/customIcon/avatar.jpg"><meta itemprop=name content="Jackson.tmm"></span><span hidden itemprop=publisher itemscope itemtype=http://schema.org/Organization><meta itemprop=name content="Jackson.tmm"><meta itemprop=description content="簡單紀錄生活和筆記"></span><span hidden itemprop=post itemscope itemtype=http://schema.org/CreativeWork><meta itemprop=name content="[筆記] 淺談資料庫事務(Transcation)"><meta itemprop=description content="database-transcation"></span><header class=post-header><h1 class=post-title itemprop="name headline">[筆記] 淺談資料庫事務(Transcation)</h1><div class=post-meta-container><div class=post-meta-items><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar"></i>
</span><span class=post-meta-item-text title=發表於>發表於：
</span><time title="創建時間：2024-11-23 22:11:45 +08:00" itemprop="dateCreated datePublished" datetime="2024-11-23 22:11:45 +0800 +0800">2024-11-23
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-calendar-check"></i>
</span><span class=post-meta-item-text title=更新於>更新於：
</span><time title="修改時間：2024-12-01 22:25:45 +08:00" itemprop="dateModified dateLastmod" datetime="2024-12-01 22:25:45 +0800 +0800">2024-12-01
</time></span><span class=post-meta-item><span class=post-meta-item-icon><i class="fas fa-solid fa-folder-open"></i>
</span><span class=post-meta-item-text title=分類於>分類於：
</span><span itemprop=about itemscope itemtype=http://schema.org/Thing><a href=/categories/note/ itemprop=url rel=index><span itemprop=name>note</span></a></span></span></div><div class=post-meta-items><span class=post-meta-item title=字數><span class=post-meta-item-icon><i class="fas fa-solid fa-file-word"></i>
</span><span class=post-meta-item-text>字數：</span>
<span>7475</span>
</span><span class=post-meta-item title=閱讀><span class=post-meta-item-icon><i class="fas fa-solid fa-clock"></i>
</span><span class=post-meta-item-text>閱讀：&ap;</span>
<span>15分鐘</span>
</span><span class=post-meta-item title=瀏覽><span class=post-meta-item-icon><i class="fas fa-solid fa-eye"></i>
</span><span class=post-meta-item-text>瀏覽：
</span><span id=busuanzi_value_page_pv data-path=/posts/note/database-transaction/><i class="fa fa-sync fa-spin"></i>
</span></span><span class=post-meta-item title><span class=post-meta-item-icon><i class="fas fa-solid fa-comments"></i>
</span><span class=post-meta-item-text title=評論>評論：
</span><span id=comments-count class=waline-comment-count data-path=/posts/note/database-transaction/><i class="fa fa-sync fa-spin"></i></span></span></div></div></header><div class="post-body autonumber" itemprop=articleBody><div class=post-summary-wrapper><div class=summary-title><span><i class="fa-solid fa-list"></i></span>
<span>總結摘要</span></div><div class=summary-content>database-transcation</div></div><h2 id=簡介>簡介
<a class=header-anchor href=#%e7%b0%a1%e4%bb%8b></a></h2><p>這篇文章主要是想要討論一下資料庫筆一個重要的概念<strong>事務(Transcation)</strong>。接下來的文章主要會分成一下幾個部分繼續討論：</p><ol><li>什麼是資料庫的事務(Transcation)</li><li>事務(Transcation)的4大特性為何</li><li>一致性問題和解決方法</li><li>MVCC和鎖的簡單介紹</li></ol><h2 id=什麼是事務transcation>什麼是事務(Transcation)
<a class=header-anchor href=#%e4%bb%80%e9%ba%bc%e6%98%af%e4%ba%8b%e5%8b%99transcation></a></h2><p>在資料庫系統中，我們都會對數據進行讀寫操作，但是如果我們要對數據做一系列的操作(2個或以上的操作)，正在被操作的數據我們不希望能被其他人修改從而影響了結果，而且即便途中操作失敗，也希望他能回到原本的狀態。而資料庫為我們提供一個這樣的方法使得數據的操作要麼是<strong>全部都成功，要麼全部都是失敗</strong>，這就是事務(Transcation)，也可以稱之為「交易」。</p><a id=more></a><p>一個很經典的例子「銀行轉帳」，小明給小黃轉100塊。我們期待的操作如下：</p><ol><li>小明帳戶減少100塊</li><li>小黃帳戶增加100塊</li></ol><p>這2部的操作都應該要成功執行才對，不可能小明的帳戶減少了錢，小黃的帳戶沒有增加錢或者小明的帳戶根本就沒錢，還能成功的吧？所以事務(Transcation)就是確保整個交易能夠都完成，或者都是失敗的情況並rollback會到原本的狀態。</p><h2 id=事務transcation的4大特性>事務(Transcation)的4大特性
<a class=header-anchor href=#%e4%ba%8b%e5%8b%99transcation%e7%9a%844%e5%a4%a7%e7%89%b9%e6%80%a7></a></h2><p>我們可能經常聽到資料庫的ACID，那ACID到底是什麼？能吃的嗎xD？<br>ACID 是原子性(Automicity)、一致性(Consistency)、隔離性(Isolatio)以及永續性(Durablity)的簡寫。所有資料庫的事務(Transcation)的操作都需要符合這4個特性，這也稱之為資料庫的ACID特性。</p><ul><li><strong>原子性(Automicity)</strong><br>什麼是原子性呢？簡單的來說就是整個事務(Transcation)的操作要麼就是全部被成功操作，要麼就是全部都操作失敗，不存在一部分成功一部分失敗的情況。</li><li><strong>一致性(Consistency)</strong><br>什麼是一致性呢？就是修改的數據必須符合定義好的資料庫規則。例如資料欄位型態、外鍵等。</li><li><strong>隔離性(Isolation)</strong><br>什麼是隔離性？每個獨立的事務(Transcation)是互相獨立的，不應該受到其他事務(Transcation)的影響。</li><li><strong>永續性(Durablity)</strong><br>什麼是永續性？就是事務(Transcation)提交後，被永久保存數據到硬碟的意思。</li></ul><p>從上面介紹 ACID 中，ACD 的意思就是字面上的意思很好理解，但是唯獨隔離性<code>I(Isolation)</code>比較複雜難懂一些。所以這邊會單獨拿出來討論討論！</p><h3 id=資源競爭問題>資源競爭問題
<a class=header-anchor href=#%e8%b3%87%e6%ba%90%e7%ab%b6%e7%88%ad%e5%95%8f%e9%a1%8c></a></h3><p>資料庫進行操作不讀就是寫，但在 concurrent 的情況下，對同一資源進行操作就會有一下幾種的問題：</p><ol><li>Read-Read - 對同一資源進行read的操作，這裡不會存在併發安全的問題。</li><li>Read-Write - 一方對同一資源進行讀操作，另一方對同一資源進行寫的操作。</li><li>Write-Write - 雙方都對同一資源進行寫的操作</li></ol><h3 id=read-write的問題>Read-Write的問題
<a class=header-anchor href=#read-write%e7%9a%84%e5%95%8f%e9%a1%8c></a></h3><p>如果一個 transaction 先讀，另外一個再寫，接著結束。是不會有並發安全的問題。<br>但是 transaction 一般會含有很多個子操作，所以可能會產生以下的一致性問題。</p><p>以下是常見的一致性問題：</p><h4 id=幻讀phantom-read>幻讀(Phantom read)
<a class=header-anchor href=#%e5%b9%bb%e8%ae%80phantom-read></a></h4><p>現在有個情境就是T1和T2都對數據表<code>user_record</code>進行操作。</p><ol><li>T1先讀取一次數據表返回了一筆數據</li><li>T2再對資料表新增/移除了一筆數據並提交了</li><li>T1再次讀取資料表發現跟上一次查詢的數據的數量不一樣了(出現幻覺了？)</li></ol><p>這種在同一個transaction內查詢返回數據數量不一致的情況，我們就叫它<strong>幻讀(Phantom read)</strong>,就像是出現了幻覺一樣。</p><p><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/phantom-read.png alt=phantom-read></p><h4 id=不可重複讀non-repeated-read>不可重複讀(non-repeated read)
<a class=header-anchor href=#%e4%b8%8d%e5%8f%af%e9%87%8d%e8%a4%87%e8%ae%80non-repeated-read></a></h4><p>現在有個情境就是T1和T2都對數據表<code>user_record</code>進行操作。</p><ol><li>T1查詢了id為1的user數據</li><li>T2對id為1的user數據進行了更新並提交了</li><li>T1再次查詢id為1的user數據，發現跟上一次查詢的數據不一樣了</li></ol><p>這種在同一個transaction內查詢返回的數據不一致的情況，我們就叫它<strong>不可重複讀(non-repeated read)</strong>。</p><p><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/non-repeated-read.png alt=non-repeated-read></p><h4 id=髒讀dirty-read>髒讀(dirty read)
<a class=header-anchor href=#%e9%ab%92%e8%ae%80dirty-read></a></h4><p>現在有個情境就是T1和T2都對數據表<code>user_record</code>進行操作。</p><ol><li>T1查詢了id為1的user數據</li><li>T2對id為1的user數據進行了更新但<strong>還沒提交(commited)</strong></li><li>T1再次查詢id為1的user數據，讀取到了另外一個transaction並沒有提交的數據修改</li></ol><p>這種在同一個transaction內讀取到另一個transactio還沒被提交的數據，我們就叫它<strong>髒讀(dirty read)</strong>。</p><p><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/dirty-read.png alt=dirty-read></p><p><strong>總結以上這幾個一致性問題</strong></p><table><thead><tr><th style=text-align:left>問題</th><th style=text-align:center>解釋</th></tr></thead><tbody><tr><td style=text-align:left>幻讀</td><td style=text-align:center>同一事務(Transcation)中讀取到不同數量的數據</td></tr><tr><td style=text-align:left>不可重複讀</td><td style=text-align:center>同一事務(Transcation)中讀到到了不同的數據</td></tr><tr><td style=text-align:left>髒讀</td><td style=text-align:center>同一事務(Transcation)中讀取到了其他事務(Transcation)未被提交的數據</td></tr></tbody></table><h4 id=一致性問題的解決方案>一致性問題的解決方案
<a class=header-anchor href=#%e4%b8%80%e8%87%b4%e6%80%a7%e5%95%8f%e9%a1%8c%e7%9a%84%e8%a7%a3%e6%b1%ba%e6%96%b9%e6%a1%88></a></h4><p>從上述可以看到Read-Write會有可能發生上述的一致性的問題。但是如果在Write-Write的情況下呢？也就是多個transaction都對同一個資訊進行讀寫，這時候會發生什麼問題呢？是不是會發生資源競爭。<br>在<strong>寫多讀少</strong>的況下，我們第一個想法是不是就是對競爭的資源加鎖對吧？確實對於<strong>寫多讀少</strong>的情況，確實是要透過加鎖的方式的解決，但是如果是<strong>讀多寫少</strong>的情況下呢？如果也對資源加鎖的話，全部讀數據的操作不就要先等待寫的操作結束了，其他事務(Transcation)才能讀取相關數據。難不成就真的只有加鎖來解決嗎？</p><p>其實不然，對於寫操作而言要解決一致性問題，就必須透過加鎖的方式來解決，但是對於讀操作而言，我們是不是用一個機制來讀取數據就好了，例如現在有人正在對數據進行修改，我是不是只要知道這個修改前的最新數據是什麼就可以了？可以想像成Git的概念，根據不同情況來讀取不同版本的數據。這個機制就是<strong>MVCC(Multi-Version Concurrency Control)</strong>。</p><p>不過在討論MVCC之前，先來討論一下什麼是<strong>根據不同的情況來讀取不同版本的數據</strong>。
從上面的描述我們知道了，在併發讀取的時候有可能會發生幻讀、不可重複讀、髒讀這幾種情況，這幾種情況也是有影響嚴重性之分的：</p><p><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/read-consistency.png alt=read-consistency></p><p>不過這3個一致性問題也只是理論上的知識，所以database會根據隔離級別的定義實作自己的db來解決這些問題。
<strong>4種隔離級別:</strong></p><ol><li>Serializable 串行</li><li>Repeatable-Read 可重複讀</li><li>Read-Committed 讀已提交</li><li>Read-Uncommitted 讀未提交</li></ol><p>這幾個隔離級別都分別可以解決不同的一致性問題。
<img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/isolation-level.png alt=isolation-level></p><p>現在對這張圖進行說明：</p><ul><li><strong>Read-Uncommitted</strong> 這個隔離強度是最低的，可見他完全沒有解決幻讀、不可重複讀、髒讀這幾種一致性問題。</li><li><strong>Read-Committed</strong> 這個隔離強度只解決了髒讀這個一致性問題。從他字面上可以看的出來，只允許讀取提交了的事務(Transcation)的數據。</li><li><strong>Repeatable-Read</strong> 這個隔離強度解決了二個一致性問題：幻讀、不可重複讀。</li><li><strong>Serializable</strong> 這個就是最強的隔離強度，它解決了幻讀、不可重複讀、髒讀這幾種一致性問題。</li></ul><p>MVCC就可以根據這幾種隔離級別來解決一致性問題。</p><h5 id=mvccmulti-version-concurrency-control>MVCC(Multi-Version Concurrency Control)
<a class=header-anchor href=#mvccmulti-version-concurrency-control></a></h5><p>什麼是MVCC呢？<br>MVCC的概念就是在讀取數據的時候，不是直接讀取資料庫最新的數據，而是讀取最近一次讀取的數據的數據版本，就像是對數據進行Git的版本控制一樣，通過欄位進行判斷來獲取不同版本的數據。</p><p>為了更好的進行說明在這邊就先簡單的說一下MySQL保存日誌的格式:<br><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/data-field.png alt=data-field></p><ul><li>RoolPointer : 等下就會知道他的作用了xD</li><li>TrxId : 這是一個事務(Transcation)的ID，如果沒分配的話就是0</li><li>OtherInfos : 其他的信息</li><li>Datas : 真實的數據</li></ul><h5 id=版本鏈-version-chain>版本鏈 Version Chain
<a class=header-anchor href=#%e7%89%88%e6%9c%ac%e9%8f%88-version-chain></a></h5><p>若一筆數據被操作的次數多了，就會通過日誌來記錄每一次的操作資訊並透過<code>RollPointer</code>來連接起來,形成一條單向鏈。
<img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/version-chain.png alt=version-chain>
這邊先從事務(Transcation)100開始進行更新操作，接著就是事務(Transcation)200連續更新了2次，最後再是事務(Transcation)300更新了一次，這樣就形成了一條版本鏈。 資料庫通過版本鏈來控制不同事物訪問對相同數據，這就是MVCC的基本概念。</p><h5 id=各隔離級別如何透過版本鏈解決問題>各隔離級別如何透過版本鏈解決問題
<a class=header-anchor href=#%e5%90%84%e9%9a%94%e9%9b%a2%e7%b4%9a%e5%88%a5%e5%a6%82%e4%bd%95%e9%80%8f%e9%81%8e%e7%89%88%e6%9c%ac%e9%8f%88%e8%a7%a3%e6%b1%ba%e5%95%8f%e9%a1%8c></a></h5><p>對於隔離級別<code>read-uncommitted</code>來說，不需要解決，因為根本就沒差別。<br>對於隔離級別<code>Serializable</code>來說，需要通過鎖才能實現，MVCC容不下這尊大佛。</p><p>對於其餘的2種隔離級別<code>Read-Committed</code>和<code>Repeatable-Read</code>來說可以通過版本鏈來解決。現在我們知道了MVCC機制是通過版本鏈來記錄相同數據的不同版本，但問題是<strong>如何通過版本鏈來解決一致性問題</strong>？那些數據才能被當前事務(Transcation)是可讀取的，那些數據是不能讀取呢。這裡InnoDB就提出來一個概念：<br><strong>ReadView</strong>
在 ReadView 裡面保存著一些數據，通過判斷當前事務(Transcation)和ReadView中的數據的版本來判斷這些數據是否可以被讀取。</p><ul><li><code>m_ids</code> - 在生成RV時，當前系統active的事務(Transcation)的id</li><li><code>min_trx_id</code> - 最小的事務(Transcation)ID，也就是<code>m_ids</code>列表中最小的<code>trx_id</code></li><li><code>max_trx_id</code> - 最大的事務(Transcation)ID，也就是<code>m_ids</code>列表中最大的<code>trx_id</code></li><li><code>create_trx_id</code> - 建立RV的事務(Transcation)ID</li></ul><p>有了這些資料結構後，只要按照規則走就可以知道MVCC的鏈中版本對當前事務(Transcation)是可讀取的/可見的。</p><ol><li>從版本鏈的最頂端也就是最新版開始進行判斷</li><li>若訪問的版本的<code>trx_id</code>與RV的<code>create_trx_id</code>相符，可以訪問數據</li><li>若訪問的版本<code>trx_id &lt; min_trx_id</code>，也就是說在生成RV的時候已經被提交了，可以訪問數據</li><li>若訪問版本的<code>trx_id > max_trx_id</code>，也就是說在生成RV之後才被建立的，不可以訪問</li><li>若訪問的版本的<code>trx_id</code>在<code>min_trx_id</code>和<code>max_trx_id</code>之間，就需要看看<code>trx_id</code>是否在<code>m_ids</code>中，如果在就表示生成RV的時候是active德狀態，不可以訪問，不在就可以訪問。</li><li>如果當前版本對事務(Transcation)不可見，就沿著鏈往下走，並重複步驟1-5。</li></ol><p>對於不同的隔離級別<code>Read-Committed</code>和<code>Repeatable-Read</code>的不同就是生成RV的方式不同:</p><ul><li><code>Read-Committed</code> 每次讀取數據都會生成新的RV</li><li><code>Repeatable-Read</code> 只有在第一次讀取時候才會生成，之後無論多少次select都會使用之前生成的RV</li></ul><h6 id=簡單例子>簡單例子
<a class=header-anchor href=#%e7%b0%a1%e5%96%ae%e4%be%8b%e5%ad%90></a></h6><p><strong>Read-Committed</strong>
現在我們有3個事務(Transcation)分別為T1, T2 和 T3，他們都會分別對數據表<code>user_record</code>進行操作，我們來看看他在隔離級別下的行為會怎麼樣的。</p><blockquote><p>！InnoDB預設的隔離級別為repeatable-Read，所以這裡要先設置為read-committed<br><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/mvcc-example1.png alt=mvcc-example3-read-commited-1></p></blockquote><ol><li>T1更新了資料庫中id為1的user數據2次但還沒有commit</li><li>T2對其他數據表進行了其他操作</li><li>T3查詢id 為1的數據且還沒commit</li></ol><p>你猜T3會傳回來的數據會是什麼呢？<br>接下來我們跟著上面所說的步驟來看看會傳回來的數據是什麼。</p><p>從版本鏈中看到：</p><ol><li><code>trx_id</code>為100且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為100且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為99且<code>trx_id &lt; min_trx_id</code>,也就是說該版本在建立ReadView的時候已經被提交了，可以訪問數據</li></ol><p>所以，最後返回的數據是<code> { id : 1, name : 'UserA', gender: 'M' }</code> ，而不是未提交的最新數據 <code>{ id : 1, name : 'user_u', gender: 'M' }</code>。是不是很神奇！！</p><p>接下來我們再做進一步的操作，看看會傳回什麼數據。
<img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/mvcc-example2.png alt=mvcc-example3-read-commited-2></p><ol><li>T1 提交了剛才的更新操作</li><li>T2 更新了數據表2次且還沒提交</li><li>T3 再次查詢id 為1的數據且還沒commit</li></ol><p>這次我們再來看看T3會回傳什麼數據？
從版本鏈中看到：</p><ol><li><code>trx_id</code>為200且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為200且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為100且<code>trx_id &lt; min_trx_id</code>,也就是說該版本在建立ReadView的時候已經被提交了(就是T1的數據在生成RV之前被提交了)，可以訪問數據</li></ol><p>所以，最後返回的數據是T1 提交過後的數據 <code>{ id : 1, name : 'user_u', gender: 'M' }</code></p><p>從這個例子可以看到，Read-Committed的隔離級別髒讀(Dirty Read)，但是不可重複讀(Non-repeated Read)還是存在的，因為可以讀取到被提交了的數據。 接下來就說說 Repeated Read 行為會怎麼樣的。</p><p><strong>Repeatable-Read</strong>
其實運作流程跟Read-Committed這個隔離級別很像的，只不過生成RV的時機是只有第一次查詢的時候。我們就拿上面的例子來說一下。
<img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/mvcc-example1.png alt=mvcc-example3-repeated-read-1></p><ol><li>T1更新了資料庫中id為1的user數據2次但還沒有commit</li><li>T2對其他數據表進行了其他操作</li><li>T3查詢id 為1的數據且還沒commit</li></ol><p>這裡就不重複說明了，跟上面是一樣的，因為這是T3第一次查詢數據表，然後就會生成一個RV。接下來就是重點呢。最後T3會回傳結果：<code>{ id : 1, name : 'UserA', gender: 'M' }</code></p><p>接著進行了以下操作：</p><ol><li>T1 提交了剛才的更新操作</li><li>T2 更新了數據表2次且還沒提交</li><li>T3 再次查詢id 為1的數據且還沒commit<br><img src=/imgs/img-lazy-loading.gif data-src=/imgs-custom/helper/transactions/mvcc-example3.png alt=mvcc-example3-repeated-read-2></li></ol><p>可以看到Read View 的內容是跟第一次查詢的是一樣的, 接著我們再按照流程走走看，會發生什麼。</p><ol><li><code>trx_id</code>為200且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為200且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為100且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為100且<code>min_trx_id</code>和<code>max_trx_id</code>之間，且在<code>m_ids</code>中存在，所以不能訪問。我們沿著鏈往下走</li><li><code>trx_id</code>為99且<code>trx_id &lt; min_trx_id</code>,也就是說該版本在建立ReadView的時候已經被提交了，可以訪問數據</li></ol><p>最後T3再次查詢後的結果依然是<code>{ id : 1, name : 'UserA', gender: 'M' }</code>,並非T1提交過後的數據 <code>{ id : 1, name : 'user_u', gender: 'M' }</code>了，也就說明了隔離了提交過後的數據了，就是這麼的神奇的機制。</p><h3 id=write-write>Write-Write
<a class=header-anchor href=#write-write></a></h3><p>我們在上面討論完讀一致性是如何解決的，接下來我們來看看寫一致性是如何解決的。寫一致性只能是透過鎖的方式來解決，也就是說我們要將數據鎖住，這樣就能確保只有一個事務(Transcation)可以對數據進行操作，這樣的話就能保證寫一致性了。</p><p>在這裡就簡單介紹一下鎖吧。</p><h4 id=鎖lock>鎖Lock
<a class=header-anchor href=#%e9%8e%96lock></a></h4><p>鎖是有顆粒度大小的，就像鎖儲物箱的一個抽屜，跟鎖整個儲物櫃的全部抽屜的區別，一個是只有被鎖的那個抽屜不能使用，而全部抽屜都鎖上的話，整個儲物櫃就不能使用了。所以資料庫也是一樣，鎖的顆粒度包含了2種：</p><ul><li>行鎖 (Row Lock) - 只鎖其中一行數據</li><li>表鎖 (Table Lock) - 整個表格都給鎖上</li></ul><p>從不同角度來看這2把鎖的話：</p><ul><li>大小 : <code>表鎖</code>><code>行鎖</code> - 表鎖 = n個行鎖</li><li>加鎖效率： <code>表鎖</code> ><code>行鎖</code> ，因為全部行都要加個鎖</li><li>衝突機率 ： <code>表鎖</code> ><code>行鎖</code>，行鎖只會擋住鎖的行的數據，表鎖則個表都不允許存取</li><li>併發性能 ： <code>表鎖</code> &lt; <code>行鎖</code> ，只對某行數據加鎖，其他行的數據不需要等待</li></ul><p>若需要把數據上鎖就包含了2個模式：</p><ol><li>共享鎖 shared Lock</li><li>排他鎖 Exclusive Lock</li></ol><h5 id=共享鎖-shared-locks鎖--讀鎖>共享鎖 shared Lock(s鎖 / 讀鎖)
<a class=header-anchor href=#%e5%85%b1%e4%ba%ab%e9%8e%96-shared-locks%e9%8e%96--%e8%ae%80%e9%8e%96></a></h5><p>簡稱<code>s鎖</code>,可以被其他事務(Transcation)讀取到，也就是多個事務(Transcation)可以共享這個鎖。這把鎖常用於讀取，也被稱爲<code>讀鎖</code>。</p><h5 id=排他鎖-exclusive-lockx鎖--寫鎖>排他鎖 Exclusive Lock(x鎖 / 寫鎖)
<a class=header-anchor href=#%e6%8e%92%e4%bb%96%e9%8e%96-exclusive-lockx%e9%8e%96--%e5%af%ab%e9%8e%96></a></h5><p>簡稱<code>x 鎖</code>，當一個事務(Transcation)獲取了某個數據的<code>x 鎖</code>，其他事務(Transcation)就不能獲取這筆數據的<code>x 鎖</code>和<code>s 鎖</code>。通常用於寫，也被稱為<code>寫鎖</code>。</p><h4 id=意向鎖-intention-lock>意向鎖 intention lock
<a class=header-anchor href=#%e6%84%8f%e5%90%91%e9%8e%96-intention-lock></a></h4><p>Mysql中有2個基本模式，<code>表鎖</code>和<code>行鎖</code>。他們也包含了<code>s 鎖</code>和<code>x 鎖</code>。</p><ul><li>表的<code>s 鎖(讀鎖)</code>,<code>x 鎖(寫鎖)</code></li><li>行的<code>s 鎖(讀鎖)</code>,<code>x 鎖(寫鎖)</code></li></ul><p>描述：
當一個事務(Transcation)給表添加了表級別的<code>s 鎖</code>：</p><ul><li>其他事務(Transcation)可以獲取該表的<code>s 鎖</code>，但無法獲取<code>x 鎖</code></li><li>其他事務(Transcation)可以繼續獲取該表某些行的<code>s 鎖</code>，但無法獲取某些行的<code>x 鎖</code></li></ul><p>當一個事務(Transcation)給表添加了表級別的<code>x 鎖</code>：</p><ul><li>其他事務(Transcation)無法獲取該表或者行的<code>s 鎖</code>和<code>x 鎖</code>，也就是什麼都不能做</li></ul><p>也就是說<strong>s 鎖與s 鎖相容(都可以獲取s鎖，無法獲取x鎖)</strong>，但<strong>x 鎖會與其他互斥都不能獲取</strong>)</p><p>如果要給行添加一個<code>s 鎖</code>，必須保證行和表級都不能有<code>x 鎖</code>，如果要添加表的<code>x鎖</code>，保證表和行級別都不能有<code>s 鎖</code> (要麼就是x鎖 要麼就是s鎖)
若是行級別還好，但是如果是表級別呢？要一行行的找嗎？</p><p><strong>意向鎖 intention lock</strong>
避免遍歷的最好的方法就是在<strong>表級別添加一個flag</strong></p><ol><li>意向共享鎖(Intension shared lock) - <code>IS鎖</code><br>當要給行級別加上<code>s鎖</code>，需要在表級別加上<code>IS 鎖</code></li><li>意向排他鎖(Intension exclusive lock) - <code>IX鎖</code><br>當要給行級別加上<code>x鎖</code>，需要在表級別加上<code>IX 鎖</code></li></ol><p>這裡一來就可以：</p><ul><li>如果要給表加上<code>s 鎖</code>，只要檢查表有沒有<code>IX鎖</code>。如有就表示表中有行級別的<code>x 鎖</code>，必須等待<code>x鎖</code>被釋放，隨後<code>IX 鎖</code>也會被釋放，這個時候就可以加表級別的<code>s 鎖了</code></li><li>如果要給表加上<code>x 鎖</code>，只要檢查表有沒有<code>IX鎖</code>或<code>IS鎖</code>。如有就表示表中有行級別的<code>x 鎖</code>或<code>s 鎖</code>，必須等待<code>x鎖</code>或者<code>s鎖</code>被釋放，隨後<code>IX 鎖</code>或<code>IS鎖</code>也會被釋放，這個時候就可以加表級別的<code>x 鎖了</code></li></ul><blockquote><p>意向鎖和意向鎖之間是不衝突<br>意向鎖和行鎖之間是不衝突</p></blockquote><p>也就是是添加行級別的<code>s鎖</code>或<code>x鎖</code>時，不需要關心是否添加了<code>IS鎖</code>或<code>IX鎖</code>。只有添加表級別的時候才需要檢查和判斷</p><p><strong>綜合不同的鎖</strong></p><table><thead><tr><th>名稱</th><th>級別</th><th>說明</th></tr></thead><tbody><tr><td>s鎖(共享鎖)</td><td>行/表級別</td><td>其他事務(Transcation)都可以讀取數據，不會被鎖住，其他事務(Transcation)可以獲得s鎖，但是不能獲得x鎖，也就是不能寫</td></tr><tr><td>x鎖(互斥鎖)</td><td>行/表級別</td><td>其他事務(Transcation)都不能讀也不能寫，其他事務(Transcation)不能獲得s鎖和x鎖，也就是說不能讀也不能寫</td></tr><tr><td>IS鎖(意向共享鎖)</td><td>行級別</td><td>用於表示事務(Transcation)在該表加了s鎖，一個表可以多個，需要添加表級別鎖時候檢查</td></tr><tr><td>IX鎖(意向互斥鎖)</td><td>行級別</td><td>用於表示事務(Transcation)在該表加了x鎖，一個表可以多個，需要添加表級別鎖時候檢查</td></tr></tbody></table><h2 id=總結>總結
<a class=header-anchor href=#%e7%b8%bd%e7%b5%90></a></h2><p>以上就是對資料庫事務(Transcation)的淺談，這篇文章中我們討論了事務(Transcation)是什麼、事務(Transcation)的ACID、隔離性的讀一致性以及隔離級別、MVCC和鎖的簡單介紹。</p><h2 id=參考資料>參考資料
<a class=header-anchor href=#%e5%8f%83%e8%80%83%e8%b3%87%e6%96%99></a></h2><p><a href=https://juejin.cn/user/888061126511720/posts title=事务的隔离级别与MVCC rel="noopener external nofollow noreferrer" target=_blank class=exturl>事务的隔离级别与MVCC
<i class="fa fa-external-link-alt"></i></a></p></div><footer class=post-footer><div class=post-tags><a href=/tags/database/>database</a></div><hr><div class=post-copyright><img src=/imgs/cc/cc.svg class=cc-icon width=75 height=75 align=right alt=共享知識 title=共享知識><ul><li class=post-copyright-title><strong>文章標題：</strong>
[筆記] 淺談資料庫事務(Transcation)</li><li class=post-copyright-author><strong>本文作者： </strong>Jackson.tmm</li><li class=post-copyright-link><strong>本文鏈接：</strong>
<a id=post-cr-link href=https://ryantokmanmokmtm.github.io/posts/note/database-transaction/ title="[筆記] 淺談資料庫事務(Transcation)">https://ryantokmanmokmtm.github.io/posts/note/database-transaction/</a></li><li class=post-copyright-license><strong>版權聲明： </strong>本作品採用 <i class="fab fa-fw fa-creative-commons"></i><a target=_blank href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hant>BY-NC-SA</a> 授權協議。轉載請註明出處！</li><li><div class=license-icons><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh-hant target=_blank><img src=/imgs/cc/big/by_nc_sa.svg alt=BY-NC-SA title=BY-NC-SA>
</a><a href=https://notbyai.fyi target=_blank><img src=/imgs/notbyai/zh-hant/white.svg title="Not By AI"></a></div></li></ul></div><div class=followme><span>歡迎關注我的其它發布渠道</span><div class=social-list><div class=social-item><a target=_blank class=social-link href=https://www.instagram.com/tm_m.0418/><span class=icon><i class="fab fa-instagram"></i>
</span><span class=label>Instagram</span></a></div><div class=social-item><a target=_blank class=social-link href=https://www.linkedin.com/in/jackson-moktokman><span class=icon><i class="fab fa-linkedin"></i>
</span><span class=label>LinkedIn</span></a></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=/posts/note/database-index/ rel=next title="[筆記] 資料庫索引(index)"><i class="fa fa-chevron-left"></i> [筆記] 資料庫索引(index)</a></div><div class="post-nav-prev post-nav-item"><a href=/posts/share/2024-swe-interview-summary/ rel=prev title="2024年軟體工程師(Software engineer)面試總結">2024年軟體工程師(Software engineer)面試總結
<i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div id=comments class=post-comments><div class=comment-head><div class=comment-headline><i class="fas fa-comments fa-fw"></i>
<span></span></div></div><div class=comment-wrap><div><div class=comment-loading><i class="fa fa-sync fa-spin"></i></div><div class=utterances-container></div></div></div></div></div></main><footer class=footer><div class=footer-inner><div class=copyright>&copy;
<span itemprop=copyrightYear>2022 - 2025
</span><span class=with-love><i class="fa fa-heart"></i>
</span><span class=author itemprop=copyrightHolder>Jackson.tmm</span></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.0.min.js></script><div class="pio-container left"><div class=pio-action></div><canvas id=pio width=300 height=500></canvas></div></div><div class=elfsight-app-b04b61d3-ff26-4d9d-a289-163c1b59bd32 data-elfsight-app-lazy></div></div></footer><script class=next-config data-name=page type=application/json>{"comments":true,"expired":false,"isHome":false,"isPage":true,"path":"database-transaction","permalink":"https://ryantokmanmokmtm.github.io/posts/note/database-transaction/","title":"[筆記] 淺談資料庫事務(Transcation)","toc":true,"waline":{"commentcnt":{"alias":"@waline/client","alias_name":"waline","file":"dist/comment.js","name":"comment","version":"2.15.8"}}}</script><script type=text/javascript src=https://ryantokmanmokmtm.github.io/js/3rd/animejs/3.2.2/anime.min.js crossorigin=anonymous defer></script><script type=text/javascript src=https://ryantokmanmokmtm.github.io/js/3rd/viewerjs/1.11.6/viewer.min.js crossorigin=anonymous defer></script><script class=next-config data-name=main type=application/json>{"bookmark":{"color":"#222","enable":true,"save":"manual"},"copybtn":true,"darkmode":true,"giscus":{"cfg":{"category":"Comments","categoryid":null,"emit":false,"inputposition":"top","mapping":"title","reactions":false,"repo":"username/repo-name","repoid":null,"theme":"preferred_color_scheme"},"js":"https://giscus.app/client.js"},"hostname":"https://ryantokmanmokmtm.github.io/","i18n":{"ds_day":" 天前","ds_days":" 天 ","ds_hour":" 小時前","ds_hours":" 小時 ","ds_just":"剛剛","ds_min":" 分鐘前","ds_mins":" 分鐘","ds_month":" 個月前","ds_years":" 年 ","empty":"沒有找到任何搜索結果：${query}","hits":"找到 ${hits} 個搜索結果","hits_time":"找到 ${hits} 個搜索結果（用時 ${time} 毫秒）","placeholder":"搜索..."},"isMultiLang":false,"lang":"zh-tw","lazyload":false,"localSearch":{"enable":true,"limit":1e3,"path":"/searchindexes.xml","preload":false,"topnperarticle":-1,"trigger":"auto","unescape":false},"motion":{"async":true,"enable":true,"transition":{"collheader":"slideInRight","postblock":"fadeIn","postbody":"fadeInDown","postheader":"fadeInDown","sidebar":"fadeInUp"}},"postmeta":{"comments":{"enable":true,"plugin":"waline"},"views":{"enable":true,"plugin":"busuanzi"}},"root":"/","scheme":"Gemini","share":{"addtoany":{"js":"https://static.addtoany.com/menu/page.js","locale":"zh-CN","num":8},"enable":false},"sidebar":{"display":"post","offset":12,"padding":18,"position":"left","width":256},"utterances":{"cfg":{"issueterm":"pathname","label":"comments","repo":"RyanTokManMokMTM/RyanTokManMokMTM.github.io","theme":"github-light"},"js":"https://utteranc.es/client.js"},"vendor":{"plugins":"local","router":{"name":"local","type":"modern","url":"https://ryantokmanmokmtm.github.io/js/3rd"}},"version":"4.8.3","waline":{"cfg":{"emoji":false,"imguploader":false,"placeholder":"请文明发言哟 ヾ(≧▽≦*)o","reaction":true,"reactiontext":["点赞","踩一下","得意","不屑","尴尬","睡觉"],"reactiontitle":"你认为这篇文章怎么样？","requiredmeta":["nick","mail"],"serverurl":"https://walinejs.comment.lithub.cc","sofa":"快来发表你的意见吧 (≧∀≦)ゞ","wordlimit":200},"css":{"alias":"@waline/client","file":"dist/waline.css","name":"waline","version":"2.15.8"},"js":{"alias":"@waline/client","file":"dist/waline.js","name":"waline","version":"2.15.8"}}}</script><script type=text/javascript src="/js/main.min.js?=1749921713" defer></script><script src=https://static.elfsight.com/platform/platform.js data-use-service-core defer></script><script src=/js/l2d.js></script><script src=/js/pio.js></script><script>var pio=new Paul_Pio({mode:"draggable",hidden:!0,content:{welcome:["歡迎來到Jackson的小宇宙！","今天天氣不錯，一起来玩吧！","博主有空的話，會寫一寫博客記錄一下!"],custom:[{selector:".home-social a:last-child",text:"在這里可以了解博主的日常噢~"},{selector:".post-item a",type:"read"},{selector:".post-content a, .page-content a",type:"link"}]},model:["/model/umaru/model.json","/model/tororo/tororo.model.json","/model/HN/nepmaid/model.json","/model/HN/nepgearswim/model.json","/model/HN/neptune_santa/model.json","/model/other/rem/model.json","/model/other/mei/model.json","/model/other/liang/2.json","/model/HN/noir_santa/model.json","/model/HN/noireswim/model.json","/model/other/blanc_normal/index.json","/model/other/88type_1809/normal/model.json","/model/other/88type_1809/destroy/model.json","/model/other/dsr50_1801/normal/model.json","/model/other/dsr50_1801/destroy/model.json","/model/other/g36c_1202/normal/model.json","/model/other/g36c_1202/destroy/model.json","/model/other/kp31_310/normal/model.json","/model/other/kp31_310/destroy/model.json","/model/other/kp31_1103/normal/model.json","/model/other/kp31_1103/destroy/model.json"],touch:["不可以這樣欺負我啦><"]})</script></body></html>